


```{r imports} 
library(DESeq2)
library(data.table)
library(readxl)
library(limma)
library(ggplot2)
library(ggrepel)
library(pheatmap)
library(umap)
library(apeglm)
library(EnhancedVolcano)
library(magrittr)
```
```{r full counts}
counts <- fread("../../data/novogene_raw_gene_count.xls") %>% as.data.frame

rownames(counts) <- counts$gene_id

# only AAVS1 and SATB1 cols
counts <- counts[c(2:3, 6:7, 10:11, 14:15, 18:19, 22:23)]
counts

# generate metadata for DESeq2
meta_data <- data.frame( index = colnames(counts) )
rownames(meta_data) <- meta_data$index

meta_data$condition <- as.factor(substr(meta_data$index, 6, 6))
meta_data$batch <- as.factor(substr(meta_data$index, 8, 9)) 
meta_data$cell <- as.factor(substr(meta_data$index, 1, 4))

meta_data$index <- NULL

meta_data
```



```{r}
dds <- DESeqDataSetFromMatrix(countData = counts,
                              colData = meta_data,
                              design = ~ batch + cell + condition)
dds <- DESeq(dds)
```

